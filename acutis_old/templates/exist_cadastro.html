<html>
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            * { font-family: open sans, helvetica neue, Helvetica, sans-serif; }
            .centro { margin: 0 auto; width: 650px; }
            .topo { background-color: #BA8F38; padding: 25px 0; text-align: center; }
            p { margin-bottom: 22px; }
            .body {
                border: 0.5px solid #d3d2d2;
                padding: 0 25px;
                background-color: #fafffe;
            }
            .title { font-size: 22px; color: #333333; }
            .subtitle {
                font-weight: 700;
                font-size: 25px;
                line-height: 48px;
                color: #BA8F38;
            }
            .footer {
                align-items: center;
                text-align: center;
                color: #fff;
                justify-content: center;
                background-color: #62372C;
                padding: 13px 0;
            }
            .botao {
                padding: 12px 20px;
                color: #FFF !important;
                background-color: #0f996a;
                text-decoration: none !important;
                font-size: 13px;
            }
            .button-wrapper { display: flex; gap: 15px; }
            .reject-btn { color: white !important; background-color: red; }
    
            .form-group { margin-bottom: 20px; }
            label { display: block; margin-bottom: 8px; }
            
            select, textarea, input[type="text"], input[type="month"], input[type="number"] {
                width: 100%;
                padding: 10px;
                border: 1px solid #ccc;
                border-radius: 4px;
                font-size: 16px;
            }
    
            select:focus, textarea:focus, input[type="text"]:focus, input[type="month"]:focus, input[type="number"]:focus {
                border-color: #007bff;
                outline: none;
            }
    
            input[type="radio"] { margin-right: 10px; }
            #divorciado-info, #seminario-info, #religiao-info, #saude-info, #remedio-info { display: none; margin-top: 10px; }

            .file-upload {
                position: relative;
                overflow: hidden;
                display: flex;
                justify-content: center;
                align-items: center; 
                width: 80%;
                margin: 0 auto;
            }
            
            .file-input {
                font-size: 20px;
                position: absolute;
                left: 0;
                top: 0;
                opacity: 0;
                cursor: pointer;
                width: 100%;
                height: 100%;
            }
            
            .file-label {
                display: flex;
                justify-content: center;
                align-items: center;
                padding: 40px 20px;
                border: 1px solid #ccc;
                border-radius: 5px;
                background-color: #f7f7f7;
                color: #333;
                cursor: pointer;
                transition: background-color 0.3s ease;
                width: 100%;
            }
            
            .file-label:hover {
                background-color: #e7e7e7;
            }
            
            .file-label:active {
                background-color: #d7d7d7;
            }
            
            .file-label i {
                margin-right: 10px;
            }

            label {
                font-weight: 600;
            }

            .btn-submit {
                margin-top: 20px; 
                padding: 12px 24px; 
                border: none; 
                border-radius: 5px; 
                background-color: #007bff; 
                color: white; 
                font-size: 16px; 
                font-weight: bold;
                cursor: pointer; 
                transition: background-color 0.3s ease, transform 0.2s ease; 
                display: inline-block; 
            }
            
            .btn-submit:hover {
                background-color: #0056b3; 
                transform: translateY(-2px); 
            }
            
            .btn-submit:active {
                background-color: #004494; 
                transform: translateY(0); 
            }
            
            .btn-submit:focus {
                outline: none; 
                box-shadow: 0 0 5px rgba(0, 123, 255, 0.5); 
            }

            .obrigatorio {
                color: red;
                font-weight: bold;
            }

            .message {
                margin-top: 5vh;
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 4px;
                display: none;
            }
            
            .success {
                color: #155724;
                background-color: #d4edda;
                border: 1px solid #c3e6cb;
            }
            
            .error {
                color: #721c24;
                background-color: #f8d7da;
                border: 1px solid #f5c6cb;
            }
        </style>
    </head>
    <body>      
        <div class="centro">
            <div class="topo">
                <img src="https://doe.institutohesed.org.br/assets/logo-1-cpFNl0o8.png" width="200px" alt="">
            </div>
            <div class="body">
                <h4 class="subtitle">Olá, {{nome}}.</h4>
                <p><b>Ficamos felizes por lhe ter nessa nova etapa.</b></p>
                <p><b>Verificamos que sua ficha cadastral foi preenchida e está em análise. Em breve iremos entrar em contato para lhe atualizar sobre o andamento do processo!</b><br/><br/></p>
                <p>Se você tiver alguma dúvida ou precisar de ajuda, não hesite em entrar em contato com nossa equipe de suporte ao cliente, que está disponível para ajudá-lo com qualquer problema ou preocupação.</p>
                <p>Caso não seja você, por favor, desconsidere este e-mail.</p>
                <p><br/></p>
                </div>
                <div class="footer">
                    <p><b>Fale Conosco</b><br/><br/>
                    (84) 9 9123-4567 | <a href="mailto:contato@institutohesed.org.br" style="color: #FFF; text-decoration: none;">contato@institutohesed.org.br</a></p>
                </div>
            </div>
        </div>
        <script>
            function toggleDivorciadoInput() {
                const divorciadoInput = document.getElementById('divorciado-info');
                const divorciadoRadio = document.getElementById('estado_civil_divorciado');
                divorciadoInput.style.display = divorciadoRadio.checked ? 'block' : 'none';
            }

            function toggleSeminarioInput() {
                const seminarioYes = document.getElementById('seminario_sim');
                const seminarioInput = document.getElementById('seminario-info');
                seminarioInput.style.display = seminarioYes.checked ? 'block' : 'none';
            }

            function toggleReligiaoInput() {
                const religiaoYes = document.getElementById('religiao_sim');
                const religiaoInput = document.getElementById('religiao-info');
                religiaoInput.style.display = religiaoYes.checked ? 'block' : 'none';
            }

            function toggleSaudeInput() {
                const saudeYes = document.getElementById('saude_sim');
                const saudeInput = document.getElementById('saude-info');
                saudeInput.style.display = saudeYes.checked ? 'block' : 'none';
            }

            function toggleRemedioInput() {
                const remedioYes = document.getElementById('remedio_sim');
                const remedioInput = document.getElementById('remedio-info');
                remedioInput.style.display = remedioYes.checked ? 'block' : 'none';
            }

            function updateLabel(input) {
                const label = input.nextElementSibling;
                if (input.files.length > 0) {
                    label.textContent = input.files[0].name;
                } else {
                    label.textContent = "Escolha uma foto...";
                }
            }

            document.getElementById('ficha-vocacional-form').addEventListener('submit', function (event) {
                event.preventDefault();
            
                const formData = new FormData(this);
                const messageDiv = document.getElementById('message');

                function formatDateToYYYYMMDD(date) {
                    return date ? `${date}-01` : null;
                }
            
                const fotoInput = formData.get('foto_vocacional');
            
                const data = {
                    escolaridade: formData.get('escolaridade'),
                    profissao: formData.get('profissao'),
                    justificativa_divorcio: formData.get('divorciado_details'),
                    sacramentos: formData.get('sacramentos'),
                    estado_civil: formData.get('estado_civil'),
                    referencia_conhecimento_instituto: formData.get('como_nos_conheceu'),
                    motivacao_admissao_vocacional: formData.get('motivacao'),
                    identificacao_com_instituto: formData.get('identificacao'),
                    motivacao_pelo_instituto: formData.get('atencao'),
                    rotina_diaria: formData.get('dia_a_dia'),
                    seminario_vida_espirito_santo_realizado_em: formatDateToYYYYMMDD(formData.get('tempo_seminario')),
                    deixou_religiao_anterior_em: formatDateToYYYYMMDD(formData.get('tempo_religiao')),
                    aceitacao_familiar: formData.get('aceitacao_familia'),
                    problema_saude_descricao: formData.get('saude'),
                    remedio_controlado_data_inicio: formatDateToYYYYMMDD(formData.get('inicio_remedio')),
                    remedio_controlado_data_fim: formatDateToYYYYMMDD(formData.get('fim_remedio')),
                    testemunho_conversao: formData.get('testemunho_conversao'),
                    fk_cadastro_vocacional_id: formData.get('fk_cadastro_vocacional_id'),
                    foto_vocacional: null
                };
            
                if (fotoInput && fotoInput instanceof File && fotoInput.size > 0) {
                    const reader = new FileReader();
                    reader.onloadend = function () {
                        const base64data = reader.result;
                        if (base64data && base64data.startsWith('data:image/')) {
                            data.foto_vocacional = base64data;
                        }
                        sendData(data);
                    };
                    reader.readAsDataURL(fotoInput);
                } else {
                    sendData(data);
                }
            
                function sendData(data) {
                    fetch('/vocacional/ficha-vocacional-create', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    })
                    .then(response => response.json().then(data => {
                        if (response.ok) {
                            showMessage('success', 'Seu formulário foi enviado com sucesso!');
                        } else {
                            showMessage('error', data.error || 'Ocorreu um erro ao processar sua solicitação.');
                        }
                    }))
                    .catch((error) => {
                        showMessage('error', 'Erro de rede: ' + error.message);
                    });
                }
            });
            
            function showMessage(type, text) {
                const messageDiv = document.getElementById('message');
                messageDiv.className = type === 'success' ? 'message success' : 'message error';
                messageDiv.innerText = text;
                messageDiv.style.display = 'block';
            }

        </script>
    </body>
</html>